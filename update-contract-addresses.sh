#!/bin/bash

# Update Contract Addresses Script
# This script updates all environment files with the deployed contract addresses

echo "üîó Updating contract addresses in environment files..."

# Contract addresses from local deployment
MUSIC_REGISTRY="0x5FC8d32690cc91D4c39d9d3abcBD16989F875707"
NFT_MARKETPLACE="0x0165878A594ca255338adfa4d48449f69242Eb8F"
ROYALTY_DISTRIBUTOR="0xa513E6E4b8f2a923D98304ec87F64353C4D5C853"
GOVERNANCE_DAO="0x2279B7A0a67DB372996a5FaB50D91eAA73d2eBe6"

# Update root .env file
echo "üìù Updating root .env file..."
sed -i.bak "s/MUSIC_REGISTRY_ADDRESS=0x0000000000000000000000000000000000000000/MUSIC_REGISTRY_ADDRESS=$MUSIC_REGISTRY/" .env
sed -i.bak "s/NFT_MARKETPLACE_ADDRESS=0x0000000000000000000000000000000000000000/NFT_MARKETPLACE_ADDRESS=$NFT_MARKETPLACE/" .env
sed -i.bak "s/ROYALTY_DISTRIBUTOR_ADDRESS=0x0000000000000000000000000000000000000000/ROYALTY_DISTRIBUTOR_ADDRESS=$ROYALTY_DISTRIBUTOR/" .env
sed -i.bak "s/GOVERNANCE_DAO_ADDRESS=0x0000000000000000000000000000000000000000/GOVERNANCE_DAO_ADDRESS=$GOVERNANCE_DAO/" .env

# Update API .env file
echo "üìù Updating API .env file..."
sed -i.bak "s/MUSIC_REGISTRY_ADDRESS=0x0000000000000000000000000000000000000000/MUSIC_REGISTRY_ADDRESS=$MUSIC_REGISTRY/" apps/api/.env
sed -i.bak "s/NFT_MARKETPLACE_ADDRESS=0x0000000000000000000000000000000000000000/NFT_MARKETPLACE_ADDRESS=$NFT_MARKETPLACE/" apps/api/.env
sed -i.bak "s/ROYALTY_DISTRIBUTOR_ADDRESS=0x0000000000000000000000000000000000000000/ROYALTY_DISTRIBUTOR_ADDRESS=$ROYALTY_DISTRIBUTOR/" apps/api/.env
sed -i.bak "s/GOVERNANCE_DAO_ADDRESS=0x0000000000000000000000000000000000000000/GOVERNANCE_DAO_ADDRESS=$GOVERNANCE_DAO/" apps/api/.env

# Update Web .env.local file
echo "üìù Updating Web .env.local file..."
sed -i.bak "s/NEXT_PUBLIC_MUSIC_REGISTRY_ADDRESS=0x0000000000000000000000000000000000000000/NEXT_PUBLIC_MUSIC_REGISTRY_ADDRESS=$MUSIC_REGISTRY/" apps/web/.env.local
sed -i.bak "s/NEXT_PUBLIC_NFT_MARKETPLACE_ADDRESS=0x0000000000000000000000000000000000000000/NEXT_PUBLIC_NFT_MARKETPLACE_ADDRESS=$NFT_MARKETPLACE/" apps/web/.env.local
sed -i.bak "s/NEXT_PUBLIC_ROYALTY_DISTRIBUTOR_ADDRESS=0x0000000000000000000000000000000000000000/NEXT_PUBLIC_ROYALTY_DISTRIBUTOR_ADDRESS=$ROYALTY_DISTRIBUTOR/" apps/web/.env.local
sed -i.bak "s/NEXT_PUBLIC_GOVERNANCE_DAO_ADDRESS=0x0000000000000000000000000000000000000000/NEXT_PUBLIC_GOVERNANCE_DAO_ADDRESS=$GOVERNANCE_DAO/" apps/web/.env.local

# Clean up backup files
rm -f .env.bak apps/api/.env.bak apps/web/.env.local.bak

echo "‚úÖ Contract addresses updated successfully!"
echo ""
echo "üìã Contract Addresses:"
echo "MusicRegistry: $MUSIC_REGISTRY"
echo "NFTMarketplace: $NFT_MARKETPLACE"
echo "RoyaltyDistributor: $ROYALTY_DISTRIBUTOR"
echo "GovernanceDAO: $GOVERNANCE_DAO"
